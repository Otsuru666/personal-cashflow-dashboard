# キャッシュフローダッシュボード

Google Sheetsの家計簿データを読み込み、帳簿上収支と実質収支（同棲費用の清算分）を可視化するダッシュボードです。

## 公開URL
[https://Otsuru666.github.io/personal-cashflow-dashboard/](https://Otsuru666.github.io/personal-cashflow-dashboard/)

## 構成
- フロント: Vite + React + Tailwind CSS + Recharts
- データ: Google Sheets
- API: Google Apps Script (GAS)
- 公開: GitHub Pages

## 事前準備（スプレッドシート）
1. スプレッドシートに家計簿データを貼り付けます。
2. タブ名は `2026_CSV` のように末尾を `_CSV` にします（複数年度OK）。
3. 1行目に以下の列名を用意します。
   - `日付`, `内容`, `金額（円）`, `大項目`, `中項目`, `区分`, `計算対象`, `メモ`
4. 「区分」列は `収入` / `支出` / `調整` のいずれかを入れます（`給与` などは収入として推定されますが、明記推奨）。
5. 「計算対象」列が `1` の行のみ集計されます。
6. 「中項目」に `自費` が含まれる支出は共同生活費の対象外になります。

## GASのセットアップ
1. スプレッドシートの「拡張機能」>「Apps Script」を開く
2. `GAS_LivingExpense.gs` の内容を貼り付けて保存
3. 「デプロイ」>「新しいデプロイ」
   - 種類: `ウェブアプリ`
   - 実行: `自分`
   - アクセス: `全員`
4. 発行されたURLを控える

## ローカル起動
```bash
npm install
npm run dev
```
初回起動時は既定のGAS URLで自動取得します。変更する場合のみ設定画面で入力してください。

## GitHub Pagesで公開
1. GitHubにこのリポジトリを作成してpush
2. `main` ブランチへpushすると自動でPagesへデプロイされます
3. GitHubの「Settings」>「Pages」で公開URLを確認

※ デフォルトブランチが `master` の場合は `.github/workflows/deploy.yml` の分岐名を修正してください。

## GAS URLの変更
- 画面右上の歯車アイコンから再設定できます
- 変更はブラウザの `localStorage` に保存されます
- 既定URLを変更したい場合は `src/App.jsx` の `DEFAULT_GAS_URL` を編集してください

## 収支の考え方
- 帳簿上収支 = 収入 - 支出 + 調整
- 実質収支 = 帳簿上収支 + (彼女の支払額 - 入金済み)
- 彼女の支払額 = 家賃・光熱費(固定 40,000円) + 共同生活費の折半分 + 立替全額 - 彼女の立替入力(折半分)
- 入金済み = `区分=収入` かつ `大項目/中項目/内容` に `同棲費用` を含むもの
- 分割払い補正 = カード引落が帳簿に入っていない分を控除（例: 三井住友カードの分割分）
- サブスク一覧 = `大項目=通信費` かつ `中項目 or 内容` に `サブスク` を含む支出

## 彼女の立替入力
- 画面内の「彼女の立替入力」に金額を入れると、折半分が彼女の支払額から差し引かれます
- 入力値は年月ごとに `localStorage` に保存されます

## 技術スタック
- React 18
- Vite
- Tailwind CSS
- Recharts
- Google Apps Script
